<!doctype html>
<html lang="fr">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Medico - Cr√©er une actualit√©</title>
</head>
<body>
    <header class="main_header">
        <div class="header_content">
            <h2>üè• Medico</h2>
        </div>
    </header>

    <div class="form-container">
        <h2>‚úçÔ∏è Cr√©er un nouveau Actualit√©</h2>
        <p class="form-subtitle">Partagez vos connaissances en sant√© et bien-√™tre</p>

        <!-- Alerts -->
        <div *ngIf="success" class="alert alert-success">
            ‚úÖ {{ success }}
            <button class="alert-close" (click)="success = ''">√ó</button>
        </div>
        <div *ngIf="error" class="alert alert-error">
            ‚ùå {{ error }}
            <button class="alert-close" (click)="error = ''">√ó</button>
        </div>

        <form [formGroup]="publicationForm" (ngSubmit)="onSubmit()">
            
            <!-- Titre -->
            <div class="form-group">
                <label for="titre">
                    üìù Titre de l'Actualit√© <span class="required">*</span>
                </label>
                <input 
                    type="text" 
                    id="titre" 
                    formControlName="titre"
                    placeholder="Ex: Comment pr√©venir les maladies cardiovasculaires"
                    [class.is-invalid]="submitted && f['titre'].errors"
                />
                <div class="invalid-feedback" *ngIf="submitted && f['titre'].errors">
                    <div *ngIf="f['titre'].errors['required']">Le titre est requis</div>
                    <div *ngIf="f['titre'].errors['minlength']">
                        Le titre doit contenir au moins 5 caract√®res
                    </div>
                </div>
            </div>

            <!-- Auteur (Auto-rempli) -->
            <!-- <div class="form-group">
                <label for="auteur">
                    üë®‚Äç‚öïÔ∏è Auteur <span class="required">*</span>
                </label>
                <input 
                    type="text" 
                    id="auteur" 
                    formControlName="auteur"
                    placeholder="Votre nom sera automatiquement ajout√©"
                    [class.is-invalid]="submitted && f['auteur'].errors"
                    readonly
                />
                <small class="form-text">Ce champ est automatiquement rempli avec votre nom</small>
            </div> -->

            <!-- Contenu -->
            <div class="form-group">
                <label for="contenu">
                    üìÑ Contenu de l'actualit√© <span class="required">*</span>
                </label>
                <textarea 
                    id="contenu" 
                    formControlName="contenu"
                    rows="10"
                    placeholder="R√©digez le contenu d√©taill√© de votre conseil (minimum 50 caract√®res)"
                    [class.is-invalid]="submitted && f['contenu'].errors"
                ></textarea>
                <div class="char-count" [style.color]="publicationForm.value.contenu?.length >= 50 ? '#28a745' : '#666'">
                    {{ publicationForm.value.contenu?.length || 0 }} / 50 caract√®res minimum
                </div>
                <div class="invalid-feedback" *ngIf="submitted && f['contenu'].errors">
                    <div *ngIf="f['contenu'].errors['required']">Le contenu est requis</div>
                    <div *ngIf="f['contenu'].errors['minlength']">
                        Le contenu doit contenir au moins 50 caract√®res
                    </div>
                </div>
            </div>

            <!-- Image URL -->
            <div class="form-group">
                <label for="image">üì∑ Image (optionnel)</label>
                <input
                  type="file"
                  id="image"
                  (change)="onFileSelected($event)"
                  accept="image/*"
                  class="form-control"
                />
                <small class="form-text">Formats accept√©s: JPG, PNG, GIF (max 5MB)</small>
              
                <!-- Aper√ßu de l'image -->
                <div class="image-preview" *ngIf="imagePreview">
                  <img [src]="imagePreview" alt="Aper√ßu" style="max-width: 300px; margin-top: 10px; border-radius: 8px;" />
                </div>
            </div>
              

            <!-- Date de publication (auto) -->
            <div class="form-group">
                <label>
                     Date de publication
                </label>
                <div class="info-box">
                    <span class="info-icon">‚ÑπÔ∏è</span>
                    <span>La date sera automatiquement d√©finie √† la cr√©ation</span>
                </div>
            </div>
            <!-- R√©sum√© -->
            <div class="summary-section">
                <h3>üìã Aper√ßu de votre actualit√©</h3>
                <div class="summary-grid">
                    <div class="summary-item">
                        <div class="summary-label"> Titre:</div>
                        <div class="summary-value">{{ publicationForm.value.titre  }}</div>
                    </div>
                    <div class="summary-item full-width">
                        <div class="summary-label"> Contenu:</div>
                        <div class="summary-value content-preview">
                            {{ publicationForm.value.contenu | slice:0:150 }}
                            {{ publicationForm.value.contenu?.length > 150 ? '...' : '' }}
                        </div>
                    </div>
                    <div class="summary-item full-width" *ngIf="publicationForm.value.imageUrl">
                        <div class="summary-label"> Image:</div>
                        <div class="summary-value">
                            <img [src]="publicationForm.value.imageUrl"
                                 alt="Aper√ßu"
                                 class="summary-image"
                                 (error)="onImageError()">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Form Actions -->
            <div class="form-actions">
                <button type="button" class="btn btn-secondary" (click)="onReset()">
                    üîÑ R√©initialiser
                </button>
                <button type="submit" class="btn btn-primary" [disabled]="loading">
                    <span *ngIf="!loading">‚ú® Cr√©er le conseil</span>
                    <span *ngIf="loading">‚è≥ Cr√©ation en cours...</span>
                </button>
            </div>
        </form>
    </div>
</body>
</html>